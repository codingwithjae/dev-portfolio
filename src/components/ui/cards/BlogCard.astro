---
import { urlFor } from "../../../lib/sanity/sanity";

export interface Props {
  title: string;
  excerpt: string;
  slug: string;
  coverImage?: { asset: { _ref: string } } | undefined | null;
}

const { title, excerpt, slug, coverImage } = Astro.props;

const imageSrc = coverImage ? urlFor(coverImage).url() : null;
---

<a
  href={`/blog/${slug}`}
  class="block w-full max-w-[50rem] group hover:scale-[1.01] transition-transform duration-300"
>
  <article
    class="glassmorphism rounded-[1.25rem] overflow-hidden w-full h-full cursor-pointer transition-colors"
  >
    <div class="flex flex-col md:flex-row h-full">
      {
        imageSrc && (
          <div class="md:w-1/3 h-48 md:h-auto overflow-hidden">
            <img
              src={imageSrc}
              alt={title}
              class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
              width={800}
              height={400}
              loading="lazy"
              decoding="async"
            />
          </div>
        )
      }

      <div
        class={`flex flex-col justify-center p-6 md:p-8 font-display ${imageSrc ? "md:w-2/3" : "w-full"}`}
      >
        <h3
          class="text-[1.5rem] md:text-[1.8rem] font-bold leading-tight mb-3 transition-colors text-text-base group-hover:text-link-hover"
        >
          {title}
        </h3>

        <p
          class="text-[1rem] text-text-base font-sans line-clamp-2 leading-relaxed mb-6 transition-colors"
        >
          {excerpt}
        </p>

        <div
          class="flex items-center gap-2 text-text-base font-bold text-[1.1rem] group-hover:text-link-hover transition-colors"
        >
          <span>Read more</span>
          <svg
            class="w-4 h-4 transition-transform group-hover:translate-x-1"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path>
          </svg>
        </div>
      </div>
    </div>
  </article>
</a>

<script define:vars={{ title, excerpt, slug, coverImage, imageSrc }}>
  // Ensure variables are "used" for static analysis
  console.debug("BlogCard initialized");
</script>
